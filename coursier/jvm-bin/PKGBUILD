pkgname=coursier-jvm-bin
pkgver=2.0.16
pkgrel=1
pkgdesc="Pure Scala Artifact Fetching. (jvm launcher version)"
arch=('any')
url="http://get-coursier.io"
license=('Apache')
depends=('java-environment>=8' 'bash')
source=(
    "builder::https://github.com/coursier/coursier/releases/download/v${pkgver}/coursier"
    "builder.asc::https://github.com/coursier/coursier/releases/download/v${pkgver}/coursier.asc"
)
sha256sums=(
    '631e8fbc1a3beb71a7130539b3b01852cfbe02edb94c5e9c6785981a0aee1e9c'
    'd4d287b7c680db35e4b497f5b204e2b321474f8ae1aa73ff657e68d934fa859b'
)
# https://keyserver.ubuntu.com/pks/lookup?search=0x8011fd49dc1749cd64137af3cd1b9d8dc84eca56&fingerprint=on&exact=on&op=index
# gpg --keyserver keyserver.ubuntu.com --receive-keys 8011fd49dc1749cd64137af3cd1b9d8dc84eca56
validpgpkeys=(
  '8011FD49DC1749CD64137AF3CD1B9D8DC84ECA56'  # Alexandre Archambault ( Travis CI coursier )
)
noextract=("builder")

build() {
  cd "${srcdir}"
  mkdir -p cache bin
  export COURSIER_CACHE="${srcdir}/cache"
  
  sh ./builder bootstrap \
    "io.get-coursier::coursier-cli:${pkgver}" \
    --java-opt "-noverify" \
    --no-default \
    -r central \
    -r typesafe:ivy-releases \
    -f -o "bin/coursier-jvm" \
    --standalone
}

package() {
  install -D -m755 "${srcdir}/bin/coursier-jvm" "${pkgdir}/usr/bin/coursier-jvm"
}
